(window.webpackJsonp=window.webpackJsonp||[]).push([["keyed-document"],{"1EJ0":function(e,t,r){"use strict";var n=r("vOnD").default.p.withConfig({displayName:"Notice",componentId:"sc-1qon07p-0"})(["background:",";color:",";padding:10px 12px;border-radius:4px;position:relative;"],(function(e){return e.theme.sidebarBackground}),(function(e){return e.theme.sidebarText}));t.a=n},Lkrs:function(e,t,r){"use strict";r("yyme");var n=r("q1tI");t.a=function OutlineLogo(e){var t=e.size,r=void 0===t?32:t,o=e.fill,i=void 0===o?"#333":o,a=e.className;return n.createElement("svg",{fill:i,width:r,height:r,viewBox:"0 0 64 64",xmlns:"http://www.w3.org/2000/svg",className:a},n.createElement("path",{d:"M32,57.6 L32,59.1606101 C32,61.3697491 30.209139,63.1606101 28,63.1606101 C27.3130526,63.1606101 26.6376816,62.9836959 26.038955,62.6469122 L2.03895504,49.1469122 C0.779447116,48.438439 -4.3614532e-15,47.1057033 -7.10542736e-15,45.6606101 L-7.10542736e-15,18.3393899 C-7.28240024e-15,16.8942967 0.779447116,15.561561 2.03895504,14.8530878 L26.038955,1.35308779 C27.9643866,0.270032565 30.4032469,0.952913469 31.4863021,2.87834498 C31.8230858,3.47707155 32,4.15244252 32,4.83938994 L32,6.4 L34.8506085,5.54481746 C36.9665799,4.91002604 39.1965137,6.11075966 39.8313051,8.22673106 C39.9431692,8.59961116 40,8.98682435 40,9.3761226 L40,11 L43.5038611,10.5620174 C45.6959408,10.2880074 47.6951015,11.8429102 47.9691115,14.0349899 C47.9896839,14.1995692 48,14.3652688 48,14.5311289 L48,49.4688711 C48,51.6780101 46.209139,53.4688711 44,53.4688711 C43.8341399,53.4688711 43.6684404,53.458555 43.5038611,53.4379826 L40,53 L40,54.6238774 C40,56.8330164 38.209139,58.6238774 36,58.6238774 C35.6107017,58.6238774 35.2234886,58.5670466 34.8506085,58.4551825 L32,57.6 Z M32,53.4238774 L36,54.6238774 L36,9.3761226 L32,10.5761226 L32,53.4238774 Z M40,15.0311289 L40,48.9688711 L44,49.4688711 L44,14.5311289 L40,15.0311289 Z M5.32907052e-15,44.4688711 L5.32907052e-15,19.5311289 L3.55271368e-15,44.4688711 Z M4,18.3393899 L4,45.6606101 L28,59.1606101 L28,4.83938994 L4,18.3393899 Z M8,21 L12,19 L12,45 L8,43 L8,21 Z"}))}},OEJt:function(e,t,r){"use strict";r.r(t);r("oVuX"),r("NBAS"),r("rB9j"),r("Rm1S"),r("EnZy");var n=r("TyAF"),o=r("q1tI"),i=(r("ma9I"),r("2B1R"),r("UxlC"),r("LKBx"),r("ls82"),r("xweI")),a=r.n(i),c=r("TKrE"),u=r.n(c),l=r("7xvl"),s=r("QLaP"),p=r.n(s),f=r("2vnA"),d=r("Ty5D");r("4mDm"),r("07d7"),r("PKPk"),r("3bBZ"),r("Kz25");function parseDocumentSlug(e){var t;if("/"===e[0])t=e;else try{t=new URL(e).pathname}catch(e){return}return t.replace(/^\/doc\//,"")}r("7W2O"),r("NbOP"),r("2pao"),r("7DVn"),r("epQN"),r("QLeJ"),r("/95S"),r("3318");var m=r("YTAv"),y=r("9Koi"),b=r("TDoO"),h=r("uoFF"),v=r("xiXg"),g=function ErrorOffline(){var e=Object(y.a)().t;return o.createElement(b.a,null,o.createElement(v.a,{title:e("Offline")}),o.createElement("h1",null,e("Offline")),o.createElement(h.a,null,e("We were unable to load the document while offline.")))},_=(r("sMBO"),r("5DmW"),r("SYor"),r("sEfC")),O=r.n(_),w=r("tsqv"),D=r("3k8n"),E=r("LCzB"),j=r("RUHe"),P=r("vOnD"),S=r("ewKk");r("DhMN");function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function _unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(e,t)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var x=/\[(X|\s|_|-)\]\s(.*)?/gi;function getTasks(e){var t=_toConsumableArray(e.matchAll(x)),r=t.length;return r?{completed:r-t.reduce((function(e,t){return" "===t[1]?e+1:e}),0),total:r}:{completed:0,total:0}}r("s6PH");var k=r("d6B3"),C=r("Lkrs"),T=r("1fUH");var I=P.default.a.withConfig({displayName:"Branding__Link",componentId:"sc-9mmwv7-0"})(["position:fixed;bottom:0;left:0;font-weight:600;font-size:14px;text-decoration:none;border-top-right-radius:2px;color:",";display:flex;align-items:center;padding:16px;svg{fill:",";}&:hover{background:",";}"],(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.sidebarBackground})),A=function Branding(e){var t=e.href,r=void 0===t?T.a.URL:t;return o.createElement(I,{href:r},o.createElement(C.a,{size:16})," Outline")},L=r("TGVW"),R=r("bgvO"),z=r("qU9s"),M=r("rOyr"),H=r("1EJ0"),B=r("NYaN"),N=r("Oqof"),K=Object(P.default)(R.a).withConfig({displayName:"Container",componentId:"sc-3pwal4-0"})(["position:relative;"]),W=r("ml7e"),V=(r("zKZe"),r("DzJC")),U=r.n(V);function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}(e,t)||function useWindowScrollPosition_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return useWindowScrollPosition_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return useWindowScrollPosition_arrayLikeToArray(e,t)}(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useWindowScrollPosition_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var F=!1;try{var G=Object.defineProperty({},"passive",{get:function get(){F=!0}});window.addEventListener("testPassive",null,G),window.removeEventListener("testPassive",null,G)}catch(e){}var q=function getPosition(){return{x:window.pageXOffset,y:window.pageYOffset}},$={throttle:100};function _templateObject2(){var e=_taggedTemplateLiteral(["\n    display: block;\n  "]);return _templateObject2=function _templateObject2(){return e},e}function _templateObject(){var e=_taggedTemplateLiteral(["\n    margin-left: -16em;\n  "]);return _templateObject=function _templateObject(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Contents_slicedToArray(e,t){return function Contents_arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function Contents_iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}(e,t)||function Contents_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return Contents_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Contents_arrayLikeToArray(e,t)}(e,t)||function Contents_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Contents_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Contents(e){var t=e.headings,r=Contents_slicedToArray(o.useState(),2),n=r[0],i=r[1],a=function useWindowScrollPosition(e){var t=Object.assign({},$,e),r=_slicedToArray(Object(o.useState)(q()),2),n=r[0],i=r[1];return Object(o.useEffect)((function(){var e=U()((function(){i(q())}),t.throttle);return window.addEventListener("scroll",e,!!F&&{passive:!0}),function(){e.cancel(),window.removeEventListener("scroll",e)}}),[t.throttle]),n}({throttle:100});o.useEffect((function(){for(var e=0;e<t.length;e++){var r=t[e],n=window.document.getElementById(decodeURIComponent(r.id));if(n)if(n.getBoundingClientRect().top>20){var o=t[Math.max(0,e-1)];return void i(o.id)}}}),[a,t]);var c=t.reduce((function(e,t){return t.level<e?t.level:e}),1/0)-1;return o.createElement("div",null,o.createElement(J,null,o.createElement(Z,null,"Contents"),t.length?o.createElement(ee,null,t.map((function(e){return o.createElement(Y,{key:e.id,level:e.level-c,active:n===e.id},o.createElement(Q,{href:"#".concat(e.id)},e.title))}))):o.createElement(X,null,"Headings you add to the document will appear here")))}var J=Object(P.default)("div").withConfig({displayName:"Contents__Wrapper",componentId:"sc-1twifsx-0"})(["display:none;position:sticky;top:80px;max-height:calc(100vh - 80px);box-shadow:1px 0 0 ",";margin-top:40px;margin-right:2em;min-height:40px;overflow-y:auto;",";",";"],(function(e){return e.theme.divider}),Object(S.a)("desktopLarge")(_templateObject()),Object(S.a)("tablet")(_templateObject2())),Z=Object(P.default)("h3").withConfig({displayName:"Contents__Heading",componentId:"sc-1twifsx-1"})(["font-size:11px;font-weight:600;text-transform:uppercase;color:",";letter-spacing:0.04em;"],(function(e){return e.theme.sidebarText})),X=Object(P.default)(W.a).withConfig({displayName:"Contents__Empty",componentId:"sc-1twifsx-2"})(["margin:1em 0 4em;padding-right:2em;min-width:16em;width:16em;font-size:14px;"]),Y=Object(P.default)("li").withConfig({displayName:"Contents__ListItem",componentId:"sc-1twifsx-3"})(["margin-left:","px;margin-bottom:8px;padding-right:2em;line-height:1.3;border-right:3px solid ",";"],(function(e){return 10*(e.level-1)}),(function(e){return e.active?e.theme.divider:"transparent"})),Q=Object(P.default)("a").withConfig({displayName:"Contents__Link",componentId:"sc-1twifsx-4"})(["color:",";font-size:14px;&:hover{color:",";}"],(function(e){return e.theme.text}),(function(e){return e.theme.primary})),ee=Object(P.default)("ol").withConfig({displayName:"Contents__List",componentId:"sc-1twifsx-5"})(["min-width:14em;width:14em;padding:0;list-style:none;"]),te=r("O6Fj"),re=r.n(te),ne=r("x8XC"),oe=r("C0qi"),ie=r("dMl3"),ae=P.default.div.withConfig({displayName:"ClickablePadding",componentId:"uf1tc3-0"})(["min-height:10em;cursor:",";",";"],(function(e){return e.onClick?"text":"default"}),(function(e){return e.grow&&"flex-grow: 100;"})),ce=(r("tkto"),r("aoTL")),ue=r("tC9W"),le=r("HKtz"),se=r("Ej4T"),pe=(r("TeQF"),r("fbCW"),r("pjDv"),r("yq1k"),r("JTJg"),r("fV9F")),fe=r("0166"),de=r("Rcen"),me=r("AfkI");var ye=Object(n.d)((function DocumentViews(e){var t=e.document,r=e.isOpen,n=Object(y.a)().t,i=Object(me.a)(),c=i.views,u=i.presence.get(t.id),s=(u=u?Array.from(u.values()):[]).map((function(e){return e.userId})),p=u.filter((function(e){return e.isEditing})).map((function(e){return e.userId})),f=c.inDocument(t.id),d=a()(f,(function(e){return!s.includes(e.user.id)})),m=o.useMemo((function(){return d.map((function(e){return e.user}))}),[d]);return o.createElement(o.Fragment,null,r&&o.createElement(de.a,{items:m,renderItem:function renderItem(e){var t=f.find((function(t){return t.user.id===e.id})),r=s.includes(e.id),i=p.includes(e.id),a=r?n(i?"Currently editing":"Currently viewing"):n("Viewed {{ timeAgo }} ago",{timeAgo:Object(l.a)(t?Date.parse(t.lastViewedAt):new Date)});return o.createElement(fe.a,{key:e.id,title:e.name,subtitle:a,image:o.createElement(pe.b,{key:e.id,src:e.avatarUrl,size:32}),border:!1,small:!0})}}))})),be=r("P6A5"),he=r("CCSF");function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var ve=P.default.div.withConfig({displayName:"Popover__Contents",componentId:"sc-1423f06-0"})(["animation:"," 200ms ease;transform-origin:75% 0;background:",";border-radius:6px;padding:12px 24px;max-height:50vh;overflow-y:scroll;width:","px;box-shadow:",";border:",";"],he.b,(function(e){return e.theme.menuBackground}),(function(e){return e.width}),(function(e){return e.theme.menuShadow}),(function(e){return e.theme.menuBorder?"1px solid ".concat(e.theme.menuBorder):"none"})),ge=function Popover_Popover(e){var t=e.children,r=e.width,n=void 0===r?380:r,i=_objectWithoutProperties(e,["children","width"]);return o.createElement(be.a,i,o.createElement(ve,{width:n},t))};function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function DocumentMetaWithViews_objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=function DocumentMetaWithViews_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var _e=Object(P.default)(se.a).withConfig({displayName:"DocumentMetaWithViews__Meta",componentId:"tosom1-0"})(["justify-content:",";margin:-12px 0 2em 0;font-size:14px;position:relative;z-index:1;a{color:inherit;&:hover{text-decoration:underline;}}@media print{display:none;}"],(function(e){return e.rtl?"flex-end":"flex-start"})),Oe=function DocumentMetaWithViews(e){var t=e.to,r=e.isDraft,n=e.document,i=DocumentMetaWithViews_objectWithoutProperties(e,["to","isDraft","document"]),a=Object(me.a)().views,c=Object(y.a)().t,u=Object(ce.d)((function(){return a.inDocument(n.id)})),l=u.length,s=1===l&&u[0].user.id;o.useEffect((function(){n.isDeleted||a.fetchPage({documentId:n.id})}),[a,n.id,n.isDeleted]);var p=Object(ue.a)({gutter:8,placement:"bottom",modal:!0});return o.createElement(_e,_extends({document:n,to:t},i),l&&!r?o.createElement(le.a,p,(function(e){return o.createElement(o.Fragment,null," • ",o.createElement("a",e,c("Viewed by")," ",s?c("only you"):"".concat(l," ").concat(c(1===l?"person":"people"))))})):null,o.createElement(ge,_extends({},p,{width:300,"aria-label":c("Viewers"),tabIndex:0}),o.createElement(ye,{document:n,isOpen:p.visible})))},we=r("0fEf"),De=(r("x83w"),r("ufqH")),Ee=r("It+4"),je=r("55Ip");var Pe=Object(P.default)(je.a).withConfig({displayName:"HoverPreviewDocument__Content",componentId:"sc-1wvp8ge-0"})(["cursor:pointer;"]),Se=P.default.h2.withConfig({displayName:"HoverPreviewDocument__Heading",componentId:"sc-1wvp8ge-1"})(["margin:0 0 0.75em;color:",";"],(function(e){return e.theme.text})),xe=Object(n.d)((function HoverPreviewDocument(e){var t=e.url,r=e.children,n=Object(me.a)().documents,i=parseDocumentSlug(t);n.prefetchDocument(i,{prefetch:!0});var a=i?n.getByUrl(i):void 0;return a?r(o.createElement(Pe,{to:a.url},o.createElement(Se,null,a.titleWithDefault),o.createElement(Oe,{isDraft:a.isDraft,document:a}),o.createElement(o.Suspense,{fallback:o.createElement("div",null)},o.createElement(we.a,{key:a.id,defaultValue:a.getSummary(),disableEmbeds:!0,readOnly:!0})))):null})),ke=r("2/zR");function HoverPreview_extends(){return(HoverPreview_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function HoverPreview_objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=function HoverPreview_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function HoverPreview_slicedToArray(e,t){return function HoverPreview_arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function HoverPreview_iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}(e,t)||function HoverPreview_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return HoverPreview_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HoverPreview_arrayLikeToArray(e,t)}(e,t)||function HoverPreview_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HoverPreview_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HoverPreviewInternal(e){var t=e.node,r=e.documents,n=e.onClose,i=(e.event,parseDocumentSlug(t.href)),a=HoverPreview_slicedToArray(o.useState(!1),2),c=a[0],u=a[1],l=o.useRef(),s=o.useRef(),p=o.useRef(),f=function startCloseTimer(){y(),l.current=setTimeout((function(){c&&u(!1),n()}),300)},d=function stopCloseTimer(){l.current&&clearTimeout(l.current)},m=function startOpenTimer(){s.current=setTimeout((function(){return u(!0)}),300)},y=function stopOpenTimer(){s.current&&clearTimeout(s.current)};o.useEffect((function(){return i&&r.prefetchDocument(i,{prefetch:!0}),m(),p.current&&p.current.addEventListener("mouseenter",d),p.current&&p.current.addEventListener("mouseleave",f),t.addEventListener("mouseout",f),t.addEventListener("mouseover",d),t.addEventListener("mouseover",m),function(){t.removeEventListener("mouseout",f),t.removeEventListener("mouseover",d),t.removeEventListener("mouseover",m),p.current&&p.current.removeEventListener("mouseenter",d),p.current&&p.current.removeEventListener("mouseleave",f),l.current&&clearTimeout(l.current)}}),[t]);var b=t.getBoundingClientRect(),h=(p.current?p.current.getBoundingClientRect():void 0)?Math.min(b.left,window.innerWidth-16-350):b.left,v=b.left-h;return o.createElement(Ee.a,null,o.createElement(Me,{top:b.bottom+window.scrollY,left:h,"aria-hidden":!0},o.createElement("div",{ref:p},o.createElement(xe,{url:t.href},(function(e){return c?o.createElement(Ae,null,o.createElement(ze,null,o.createElement(Le,null),o.createElement(Re,null,e)),o.createElement(He,{offset:v+b.width/2})):null})))))}var Ce,Te,Ie,Ae=P.default.div.withConfig({displayName:"HoverPreview__Animate",componentId:"fupyqh-0"})(["animation:"," 150ms ease;@media print{display:none;}"],he.c),Le=P.default.div.withConfig({displayName:"HoverPreview__Margin",componentId:"fupyqh-1"})(["position:absolute;top:-11px;left:0;right:0;height:11px;"]),Re=P.default.div.withConfig({displayName:"HoverPreview__CardContent",componentId:"fupyqh-2"})(["overflow:hidden;max-height:350px;user-select:none;"]),ze=P.default.div.withConfig({displayName:"HoverPreview__Card",componentId:"fupyqh-3"})(["backdrop-filter:blur(10px);background:",";border:",';border-radius:4px;box-shadow:0 30px 90px -20px rgba(0,0,0,0.3),0 0 1px 1px rgba(0,0,0,0.05);padding:16px;width:350px;font-size:0.9em;position:relative;.placeholder,.heading-anchor{display:none;}&:after{content:"";display:block;position:absolute;pointer-events:none;background:linear-gradient( 90deg,'," 0%,"," 75%,"," 90% );bottom:0;left:0;right:0;height:1.7em;border-bottom:16px solid ",";border-bottom-left-radius:4px;border-bottom-right-radius:4px;}"],(function(e){return e.theme.background}),(function(e){return e.theme.menuBorder?"1px solid ".concat(e.theme.menuBorder):"none"}),(function(e){return Object(De.d)(1,e.theme.background)}),(function(e){return Object(De.d)(1,e.theme.background)}),(function(e){return e.theme.background}),(function(e){return e.theme.background})),Me=P.default.div.withConfig({displayName:"HoverPreview__Position",componentId:"fupyqh-4"})(["margin-top:10px;position:",";z-index:",";display:flex;max-height:75%;",";",";"],(function(e){return e.fixed?"fixed":"absolute"}),(function(e){return e.theme.depths.hoverPreview}),(function(e){var t=e.top;return void 0!==t?"top: ".concat(t,"px"):""}),(function(e){var t=e.left;return void 0!==t?"left: ".concat(t,"px"):""})),He=P.default.div.withConfig({displayName:"HoverPreview__Pointer",componentId:"fupyqh-5"})(["top:-22px;left:",'px;width:22px;height:22px;position:absolute;transform:translateX(-50%);pointer-events:none;&:before,&:after{content:"";display:inline-block;position:absolute;bottom:0;right:0;}&:before{border:8px solid transparent;border-bottom-color:',";right:-1px;}&:after{border:7px solid transparent;border-bottom-color:",";}"],(function(e){return e.offset}),(function(e){return e.theme.menuBorder||"rgba(0, 0, 0, 0.1)"}),(function(e){return e.theme.background})),Be=Object(n.c)("documents")((function HoverPreview(e){var t=e.node,r=HoverPreview_objectWithoutProperties(e,["node"]);return Object(ke.c)(t.href)?o.createElement(HoverPreviewInternal,HoverPreview_extends({},r,{node:t})):null})),Ne=r("AsFH"),Ke=r("FWla"),We=r("cUbi");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Editor_templateObject(){var e=function Editor_taggedTemplateLiteral(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    margin-left: ",";\n  "]);return Editor_templateObject=function _templateObject(){return e},e}function Editor_extends(){return(Editor_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Editor_objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=function Editor_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _initializerDefineProperty(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ve=Object(n.d)((Te=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(DocumentEditor,e);var t=_createSuper(DocumentEditor);function DocumentEditor(){var e,r;_classCallCheck(this,DocumentEditor);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return _possibleConstructorReturn(r,(e=r=t.call.apply(t,[this].concat(i)),_initializerDefineProperty(r,"activeLinkEvent",Ie,_assertThisInitialized(r)),r.ref=o.createRef(),r.focusAtStart=function(){r.props.innerRef.current&&r.props.innerRef.current.focusAtStart()},r.focusAtEnd=function(){r.props.innerRef.current&&r.props.innerRef.current.focusAtEnd()},r.insertParagraph=function(){if(r.props.innerRef.current){var e=r.props.innerRef.current.view,t=e.dispatch,n=e.state;t(n.tr.insert(0,n.schema.nodes.paragraph.create()))}},r.handleTitleKeyDown=function(e){return"Enter"===e.key?(e.preventDefault(),Object(Ke.a)(e)?void r.props.onSave({done:!0}):(r.insertParagraph(),void r.focusAtStart())):"Tab"===e.key||"ArrowDown"===e.key?(e.preventDefault(),void r.focusAtStart()):"p"===e.key&&Object(Ke.a)(e)&&e.shiftKey?(e.preventDefault(),void r.props.onSave({publish:!0,done:!0})):"s"===e.key&&Object(Ke.a)(e)?(e.preventDefault(),void r.props.onSave({})):void 0},r.handleLinkActive=function(e){r.activeLinkEvent=e},r.handleLinkInactive=function(){r.activeLinkEvent=null},e))}return function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(DocumentEditor,[{key:"render",value:function render(){var e=this.props,t=e.document,r=e.title,n=e.onChangeTitle,i=e.isDraft,a=e.shareId,c=e.readOnly,u=e.innerRef,l=e.children,s=e.policies,p=e.t,f=Editor_objectWithoutProperties(e,["document","title","onChangeTitle","isDraft","shareId","readOnly","innerRef","children","policies","t"]),d=s.abilities(t.id),m=Object(ie.a)(r).emoji,y=!(!m||!r.startsWith("".concat(m," "))),b=!r&&c?t.titleWithDefault:r;return o.createElement(R.a,{auto:!0,column:!0},c?o.createElement(Fe,{as:"div",ref:this.ref,$startsWithEmojiAndSpace:y,$isStarred:t.isStarred,dir:"auto"},o.createElement("span",null,b)," ",(d.star||d.unstar)&&o.createElement(Ue,{document:t,size:32})):o.createElement(Fe,{type:"text",ref:this.ref,onChange:n,onKeyDown:this.handleTitleKeyDown,placeholder:t.isTemplate?p("Start your template…"):p("Start with a title…"),value:b,$startsWithEmojiAndSpace:y,autoFocus:!r,maxLength:ne.b,dir:"auto"}),!a&&o.createElement(Oe,{isDraft:i,document:t,to:Object(We.b)(t),rtl:!!this.ref.current&&"rtl"===window.getComputedStyle(this.ref.current).direction}),o.createElement(we.a,Editor_extends({ref:u,autoFocus:!!r&&!this.props.defaultValue,placeholder:p("…the rest is up to you"),onHoverLink:this.handleLinkActive,scrollTo:window.location.hash,readOnly:c,shareId:a,grow:!0},f)),!c&&o.createElement(ae,{onClick:this.focusAtEnd,grow:!0}),this.activeLinkEvent&&!a&&c&&o.createElement(Be,{node:this.activeLinkEvent.target,event:this.activeLinkEvent,onClose:this.handleLinkInactive}),l)}}]),DocumentEditor}(o.Component),Ie=function _applyDecoratedDescriptor(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}(Te.prototype,"activeLinkEvent",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce=Te))||Ce,Ue=Object(P.default)(Ne.b).withConfig({displayName:"Editor__StarButton",componentId:"pvz3ff-0"})(["position:relative;top:4px;"]),Fe=Object(P.default)(re.a).withConfig({displayName:"Editor__Title",componentId:"pvz3ff-1"})(["line-height:1.25;margin-top:1em;margin-bottom:0.5em;background:",";transition:",";color:",";-webkit-text-fill-color:",";font-size:2.25em;font-weight:500;outline:none;border:0;padding:0;resize:none;&::placeholder{color:",";-webkit-text-fill-color:",";}",";","{opacity:",";}&:hover{","{opacity:0.5;&:hover{opacity:1;}}}@media print{color:",";-webkit-text-fill-color:",";background:none;}"],(function(e){return e.theme.background}),(function(e){return e.theme.backgroundTransition}),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.placeholder}),(function(e){return e.theme.placeholder}),Object(S.a)("tablet")(Editor_templateObject(),(function(e){return e.$startsWithEmojiAndSpace?"-1.2em":0})),Ne.a,(function(e){return e.$isStarred?"1 !important":0}),Ne.a,(function(e){return oe.c.text}),(function(e){return oe.c.text})),Ge=Object(E.a)()(Object(n.c)("policies")(Ve)),qe=r("VmCM"),$e=r("DdE7"),Je=r("eJ2A"),Ze=(r("FZtP"),r("7tbW")),Xe=r.n(Ze),Ye=r("k4Da"),Qe=r.n(Ye),et=r("eXkq"),tt=r("ckee");function Collaborators_templateObject(){var e=function Collaborators_taggedTemplateLiteral(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    display: none;\n  "]);return Collaborators_templateObject=function _templateObject(){return e},e}function Collaborators_extends(){return(Collaborators_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Collaborators_toConsumableArray(e){return function Collaborators_arrayWithoutHoles(e){if(Array.isArray(e))return Collaborators_arrayLikeToArray(e)}(e)||function Collaborators_iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function Collaborators_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return Collaborators_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Collaborators_arrayLikeToArray(e,t)}(e)||function Collaborators_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Collaborators_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var rt=Object(P.default)(et.a).withConfig({displayName:"Collaborators__FacepileHiddenOnMobile",componentId:"kfab1u-0"})(["",";"],Object(S.a)("mobile","tablet")(Collaborators_templateObject())),nt=Object(n.d)((function Collaborators(e){var t=Object(y.a)().t,r=Object(me.a)(),n=r.users,i=r.presence,c=e.document,u=e.currentUserId,l=i.get(c.id),s=(l=l?Array.from(l.values()):[]).map((function(e){return e.userId})),p=l.filter((function(e){return e.isEditing})).map((function(e){return e.userId})),f=o.useMemo((function(){return a()(Qe()(n.orderedData,(function(e){return s.includes(e.id)||c.collaboratorIds.includes(e.id)})),(function(e){return s.includes(e.id)}))}),[c.collaboratorIds,n.orderedData,s]);o.useEffect((function(){n.isFetching||Xe()([].concat(Collaborators_toConsumableArray(c.collaboratorIds),Collaborators_toConsumableArray(s))).forEach((function(e){if(!n.get(e))return n.fetch(e)}))}),[c,n,s,c.collaboratorIds]);var d=Object(ue.a)({gutter:0,placement:"bottom-end"});return o.createElement(o.Fragment,null,o.createElement(le.a,d,(function(e){return o.createElement(tt.a,Collaborators_extends({width:32*f.length,height:32},e),o.createElement(rt,{users:f,renderAvatar:function renderAvatar(e){var t=s.includes(e.id),r=p.includes(e.id);return o.createElement(pe.a,{key:e.id,user:e,isPresent:t,isEditing:r,isCurrentUser:u===e.id,profileOnClick:!1})}}))})),o.createElement(ge,Collaborators_extends({},d,{width:300,"aria-label":t("Viewers"),tabIndex:0}),o.createElement(ye,{document:c,isOpen:d.visible})))})),ot=r("D1uu"),it=r("aBHE"),at=r("H+FO"),ct=(r("+2oP"),r("tKKf"));function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PublicBreadcrumb_toConsumableArray(e){return function PublicBreadcrumb_arrayWithoutHoles(e){if(Array.isArray(e))return PublicBreadcrumb_arrayLikeToArray(e)}(e)||function PublicBreadcrumb_iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function PublicBreadcrumb_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return PublicBreadcrumb_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PublicBreadcrumb_arrayLikeToArray(e,t)}(e)||function PublicBreadcrumb_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PublicBreadcrumb_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ut=function PublicBreadcrumb(e){var t=e.documentId,r=e.shareId,n=e.sharedTree,i=e.children,a=o.useMemo((function(){return function pathToDocument(e,t){var r=[];return e&&function traveler(e,n){e.forEach((function(e){var o=[].concat(PublicBreadcrumb_toConsumableArray(n),[e]);if(e.id!==t)return traveler(e.children,o);r=o}))}([e],[]),r}(n,t).slice(0,-1).map((function(e){return _objectSpread(_objectSpread({},e),{},{to:"/share/".concat(r).concat(e.url)})}))}),[n,r,t]);return o.createElement(ct.a,{items:a,children:i})},lt=(r("06tf"),r("Z5Gl")),st=r("8lVk"),pt=r("LxHZ"),ft=r("6elG");function asyncGeneratorStep(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function _next(e){asyncGeneratorStep(i,n,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(i,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function SharePopover_slicedToArray(e,t){return function SharePopover_arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function SharePopover_iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}(e,t)||function SharePopover_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return SharePopover_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SharePopover_arrayLikeToArray(e,t)}(e,t)||function SharePopover_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SharePopover_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var dt=P.default.h2.withConfig({displayName:"SharePopover__Heading",componentId:"sc-19v0s84-0"})(["display:flex;align-items:center;margin-top:12px;margin-left:-4px;"]),mt=P.default.div.withConfig({displayName:"SharePopover__SwitchWrapper",componentId:"sc-19v0s84-1"})(["margin:20px 0;"]),yt=Object(P.default)(st.c).withConfig({displayName:"SharePopover__InputLink",componentId:"sc-19v0s84-2"})(["flex-grow:1;margin-right:8px;"]),bt=Object(P.default)(R.a).withConfig({displayName:"SharePopover__SwitchLabel",componentId:"sc-19v0s84-3"})(["flex-align:center;svg{flex-shrink:0;}"]),ht=Object(P.default)(W.a).withConfig({displayName:"SharePopover__SwitchText",componentId:"sc-19v0s84-4"})(["margin:0;font-size:15px;"]),vt=Object(n.d)((function SharePopover(e){var t=e.document,r=e.share,n=e.sharedParent,i=e.onSubmit,a=Object(y.a)().t,c=Object(me.a)(),u=c.policies,s=c.shares,f=Object(ft.a)().showToast,d=SharePopover_slicedToArray(o.useState(!1),2),m=d[0],b=d[1],h=o.useRef(),v=u.abilities(r?r.id:"").update&&!t.isTemplate,g=r&&r.published||n;o.useEffect((function(){return t.share(),function(){return clearTimeout(h.current)}}),[t]);var _=o.useCallback(function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function _callee(e){var r;return regeneratorRuntime.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return r=s.getByDocumentId(t.id),p()(r,"Share must exist"),n.prev=2,n.next=5,r.save({published:e.currentTarget.checked});case 5:n.next=10;break;case 7:n.prev=7,n.t0=n.catch(2),f(n.t0.message,{type:"error"});case 10:case"end":return n.stop()}}),_callee,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),[t.id,s,f]),O=o.useCallback(function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(e){var r;return regeneratorRuntime.wrap((function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:return r=s.getByDocumentId(t.id),p()(r,"Share must exist"),n.prev=2,n.next=5,r.save({includeChildDocuments:e.currentTarget.checked});case 5:n.next=10;break;case 7:n.prev=7,n.t0=n.catch(2),f(n.t0.message,{type:"error"});case 10:case"end":return n.stop()}}),_callee2,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),[t.id,s,f]),E=o.useCallback((function(){b(!0),h.current=setTimeout((function(){b(!1),i(),f(a("Share link copied"),{type:"info"})}),250)}),[a,i,f]);return o.createElement(o.Fragment,null,o.createElement(dt,null,g?o.createElement(w.GlobeIcon,{size:28,color:"currentColor"}):o.createElement(w.PadlockIcon,{size:28,color:"currentColor"})," ",a("Share this document")),n&&o.createElement(H.a,null,o.createElement(D.a,{defaults:"This document is shared because the parent <em>{{ documentTitle }}</em> is publicly shared",values:{documentTitle:n.documentTitle},components:{em:o.createElement("strong",null)}})),v&&o.createElement(mt,null,o.createElement(pt.a,{id:"published",label:a("Publish to internet"),onChange:_,checked:!!r&&r.published,disabled:!r}),o.createElement(bt,null,o.createElement(ht,null,r.published?a("Anyone with the link can view this document"):a("Only team members with permission can view"),r.lastAccessedAt&&o.createElement(o.Fragment,null,"."," ",a("The shared link was last accessed {{ timeAgo }}.",{timeAgo:Object(l.a)(Date.parse(r.lastAccessedAt),{addSuffix:!0})}))))),r&&r.published&&o.createElement(mt,null,o.createElement(pt.a,{id:"includeChildDocuments",label:a("Share nested documents"),onChange:O,checked:!!r&&r.includeChildDocuments,disabled:!r}),o.createElement(bt,null,o.createElement(ht,null,r.includeChildDocuments?a("Nested documents are publicly available"):a("Nested documents are not shared")))),o.createElement(R.a,null,o.createElement(yt,{type:"text",label:a("Link"),placeholder:"".concat(a("Loading"),"…"),value:r?r.url:"",labelHidden:!0,readOnly:!0}),o.createElement(lt.a,{text:r?r.url:"",onCopy:E},o.createElement(Je.b,{type:"submit",disabled:m||!r,primary:!0},a("Copy link")))))}));function ShareButton_extends(){return(ShareButton_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var gt=Object(n.d)((function ShareButton(e){var t=e.document,r=Object(y.a)().t,n=Object(me.a)().shares,i=n.getByDocumentId(t.id),a=n.getByDocumentParents(t.id),c=i&&i.published||a&&a.published,u=Object(ue.a)({gutter:0,placement:"bottom-end"});return o.createElement(o.Fragment,null,o.createElement(le.a,u,(function(e){return o.createElement(at.a,{tooltip:c?o.createElement(D.a,null,"Anyone with the link ",o.createElement("br",null),"can view this document"):"",delay:500,placement:"bottom"},o.createElement(Je.b,ShareButton_extends({icon:c?o.createElement(w.GlobeIcon,null):void 0,neutral:!0},e),r("Share")))})),o.createElement(ge,ShareButton_extends({},u,{"aria-label":r("Share")}),o.createElement(vt,{document:t,share:i,sharedParent:a,onSubmit:u.hide})))})),_t=r("D8KP");var Ot=r("4tgq"),wt=r("LU5X"),Dt=r("EHHx"),Et=r("W4FJ"),jt=r("NOt+");function NewChildDocumentMenu_extends(){return(NewChildDocumentMenu_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Pt=Object(n.d)((function NewChildDocumentMenu(e){var t=e.document,r=e.label,n=Object(wt.a)({modal:!0}),i=Object(me.a)().collections,a=Object(y.a)().t,c=i.get(t.collectionId),u=c?c.name:a("collection");return o.createElement(o.Fragment,null,o.createElement(Dt.a,n,r),o.createElement(Et.a,NewChildDocumentMenu_extends({},n,{"aria-label":a("New child document")}),o.createElement(jt.a,NewChildDocumentMenu_extends({},n,{items:[{title:o.createElement("span",null,o.createElement(D.a,{defaults:"New document in <em>{{ collectionName }}</em>",values:{collectionName:u},components:{em:o.createElement("strong",null)}})),to:Object(We.i)(t.collectionId)},{title:a("New nested document"),to:Object(We.i)(t.collectionId,{parentDocumentId:t.id})}]}))))}));function TableOfContentsMenu_extends(){return(TableOfContentsMenu_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function TableOfContentsMenu_toConsumableArray(e){return function TableOfContentsMenu_arrayWithoutHoles(e){if(Array.isArray(e))return TableOfContentsMenu_arrayLikeToArray(e)}(e)||function TableOfContentsMenu_iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function TableOfContentsMenu_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return TableOfContentsMenu_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TableOfContentsMenu_arrayLikeToArray(e,t)}(e)||function TableOfContentsMenu_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function TableOfContentsMenu_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var St=Object(n.d)((function TableOfContentsMenu(e){var t=e.headings,r=Object(wt.a)({modal:!0,unstable_preventOverflow:!0,unstable_fixed:!0,unstable_flip:!0}),n=Object(y.a)().t,i=t.reduce((function(e,t){return t.level<e?t.level:e}),1/0),a=o.useMemo((function(){var e=[{type:"heading",visible:!0,title:n("Contents")}].concat(TableOfContentsMenu_toConsumableArray(t.map((function(e){return{href:"#".concat(e.id),title:n(e.title),level:e.level-i}}))));return 1===e.length&&e.push({href:"#",title:n("Headings you add to the document will appear here"),disabled:!0}),e}),[n,t,i]);return o.createElement(o.Fragment,null,o.createElement(Dt.a,r,(function(e){return o.createElement(Je.b,TableOfContentsMenu_extends({},e,{icon:o.createElement(w.TableOfContentsIcon,null),iconColor:"currentColor",borderOnHover:!0,neutral:!0}))})),o.createElement(Et.a,TableOfContentsMenu_extends({},r,{"aria-label":n("Table of contents")}),o.createElement(jt.a,TableOfContentsMenu_extends({},r,{items:a}))))})),xt=r("np2L"),kt=r("y5vG");function TemplatesMenu_extends(){return(TemplatesMenu_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Ct=P.default.div.withConfig({displayName:"TemplatesMenu__TemplateItem",componentId:"sc-1fhluw0-0"})(["text-align:left;"]),Tt=P.default.div.withConfig({displayName:"TemplatesMenu__Author",componentId:"sc-1fhluw0-1"})(["font-size:13px;"]),It=Object(n.d)((function TemplatesMenu(e){var t=e.document,r=Object(wt.a)({modal:!0}),n=Object(me.a)().documents,i=Object(y.a)().t,a=n.templates;if(!a.length)return null;var c=a.filter((function(e){return e.collectionId===t.collectionId})),u=a.filter((function(e){return e.collectionId!==t.collectionId})),l=function renderTemplate(e){return o.createElement(xt.b,TemplatesMenu_extends({key:e.id,onClick:function onClick(){return t.updateFromTemplate(e)}},r),o.createElement(w.DocumentIcon,null),o.createElement(Ct,null,o.createElement("strong",null,e.titleWithDefault),o.createElement("br",null),o.createElement(Tt,null,i("By {{ author }}",{author:e.createdBy.name}))))};return o.createElement(o.Fragment,null,o.createElement(Dt.a,r,(function(e){return o.createElement(Je.b,TemplatesMenu_extends({},e,{disclosure:!0,neutral:!0}),i("Templates"))})),o.createElement(Et.a,TemplatesMenu_extends({},r,{"aria-label":i("Templates")}),c.map(l),u.length&&c.length?o.createElement(kt.a,null):void 0,u.map(l)))}));function Header_extends(){return(Header_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var At=Object(P.default)(qe.a).withConfig({displayName:"Header__Status",componentId:"sc-1t4a0uf-0"})(["padding-left:0;padding-right:4px;color:",";"],(function(e){return e.theme.slate})),Lt=Object(P.default)(qe.a).withConfig({displayName:"Header__TocWrapper",componentId:"sc-1t4a0uf-1"})(["position:absolute;left:42px;"]),Rt=Object(n.d)((function DocumentHeader(e){var t=e.document,r=e.shareId,n=e.isEditing,i=e.isDraft,a=e.isPublishing,c=e.isRevision,u=e.isSaving,l=e.savingIsDisabled,s=e.publishingIsDisabled,p=e.sharedTree,f=e.onSave,d=e.headings,m=Object(y.a)().t,b=Object(me.a)(),h=b.auth,v=b.ui,g=b.policies,_=function useMobile(){var e=Object(P.useTheme)();return Object(_t.a)("(max-width: ".concat(e.breakpoints.tablet,"px)"))}(),O=o.useCallback((function(){f({done:!0})}),[f]),D=o.useCallback((function(){f({done:!0,publish:!0})}),[f]),E=t.isNewDocument,j=t.isTemplate,S=g.abilities(t.id),x=h.team&&h.team.sharing&&S.share,k=h.team&&h.team.documentEmbeds,C=S.update&&!n,T=o.createElement(at.a,{tooltip:v.tocVisible?m("Hide contents"):m("Show contents"),shortcut:"ctrl+alt+h",delay:250,placement:"bottom"},o.createElement(Je.b,{onClick:v.tocVisible?v.hideTableOfContents:v.showTableOfContents,icon:o.createElement(w.TableOfContentsIcon,null),iconColor:"currentColor",borderOnHover:!0,neutral:!0})),I=o.createElement(qe.a,null,o.createElement(at.a,{tooltip:m("Edit {{noun}}",{noun:t.noun}),shortcut:"e",delay:500,placement:"bottom"},o.createElement(Je.b,{as:je.a,icon:o.createElement(w.EditIcon,null),to:Object(We.e)(t),neutral:!0},m("Edit"))));return r?o.createElement(it.a,{title:t.title,breadcrumb:o.createElement(ut,{documentId:t.id,shareId:r,sharedTree:p},T),actions:C?I:o.createElement("div",null)}):o.createElement(o.Fragment,null,o.createElement(it.a,{breadcrumb:o.createElement(ot.a,{document:t},!n&&T),title:o.createElement(o.Fragment,null,t.title," ",t.isArchived&&o.createElement($e.a,null,m("Archived"))),actions:o.createElement(o.Fragment,null,_&&o.createElement(Lt,null,o.createElement(St,{headings:d})),!a&&u&&o.createElement(At,null,m("Saving"),"…"),o.createElement(nt,{document:t,currentUserId:h.user?h.user.id:void 0}),n&&!j&&E&&o.createElement(qe.a,null,o.createElement(It,{document:t})),!n&&x&&(!_||!j)&&o.createElement(qe.a,null,o.createElement(gt,{document:t})),n&&o.createElement(o.Fragment,null,o.createElement(qe.a,null,o.createElement(at.a,{tooltip:m("Save"),shortcut:"".concat(Ke.c,"+enter"),delay:500,placement:"bottom"},o.createElement(Je.b,{onClick:O,disabled:l,neutral:i},m(i?"Save Draft":"Done Editing"))))),C&&I,C&&S.createChildDocument&&!_&&o.createElement(qe.a,null,o.createElement(Pt,{document:t,label:function label(e){return o.createElement(at.a,{tooltip:m("New document"),shortcut:"n",delay:500,placement:"bottom"},o.createElement(Je.b,Header_extends({icon:o.createElement(w.PlusIcon,null)},e,{neutral:!0}),m("New doc")))}})),C&&j&&!i&&!c&&o.createElement(qe.a,null,o.createElement(Je.b,{icon:o.createElement(w.PlusIcon,null),as:je.a,to:Object(We.i)(t.collectionId,{templateId:t.id}),primary:!0},m("New from template"))),S.update&&i&&!c&&o.createElement(qe.a,null,o.createElement(at.a,{tooltip:m("Publish"),shortcut:"".concat(Ke.c,"+shift+p"),delay:500,placement:"bottom"},o.createElement(Je.b,{onClick:D,disabled:s},a?"".concat(m("Publishing"),"…"):m("Publish")))),!n&&o.createElement(o.Fragment,null,o.createElement(qe.b,null),o.createElement(qe.a,null,o.createElement(Ot.a,{document:t,isRevision:c,label:function label(e){return o.createElement(Je.b,Header_extends({icon:o.createElement(w.MoreIcon,null),iconColor:"currentColor"},e,{borderOnHover:!0,neutral:!0}))},showToggleEmbeds:k,showPrint:!0}))))}))})),zt=r("lity"),Mt=r("DczD"),Ht=r("UkNe");function KeyboardShortcutsButton_templateObject(){var e=function KeyboardShortcutsButton_taggedTemplateLiteral(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    display: block;\n  "]);return KeyboardShortcutsButton_templateObject=function _templateObject(){return e},e}function KeyboardShortcutsButton_slicedToArray(e,t){return function KeyboardShortcutsButton_arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function KeyboardShortcutsButton_iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}(e,t)||function KeyboardShortcutsButton_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return KeyboardShortcutsButton_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KeyboardShortcutsButton_arrayLikeToArray(e,t)}(e,t)||function KeyboardShortcutsButton_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function KeyboardShortcutsButton_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Bt=Object(P.default)(tt.a).withConfig({displayName:"KeyboardShortcutsButton__Button",componentId:"g4oty1-0"})(["display:none;position:fixed;bottom:0;right:0;margin:24px;",";@media print{display:none;}"],Object(S.a)("tablet")(KeyboardShortcutsButton_templateObject())),Nt=function KeyboardShortcutsButton(){var e=Object(y.a)().t,t=KeyboardShortcutsButton_slicedToArray(Object(Ht.a)(),3),r=t[0],n=t[1],i=t[2];return o.createElement(o.Fragment,null,o.createElement(Mt.a,{isOpen:r,onRequestClose:i,title:e("Keyboard shortcuts")},o.createElement(zt.a,null)),o.createElement(at.a,{tooltip:e("Keyboard shortcuts"),shortcut:"?",placement:"left",delay:500},o.createElement(Bt,{onClick:n},o.createElement(w.KeyboardIcon,null))))};function MarkAsViewed_typeof(e){return(MarkAsViewed_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MarkAsViewed_asyncGeneratorStep(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function MarkAsViewed_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function _next(e){MarkAsViewed_asyncGeneratorStep(i,n,o,_next,_throw,"next",e)}function _throw(e){MarkAsViewed_asyncGeneratorStep(i,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function MarkAsViewed_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MarkAsViewed_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function MarkAsViewed_setPrototypeOf(e,t){return(MarkAsViewed_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function MarkAsViewed_createSuper(e){var t=function MarkAsViewed_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=MarkAsViewed_getPrototypeOf(e);if(t){var o=MarkAsViewed_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return MarkAsViewed_possibleConstructorReturn(this,r)}}function MarkAsViewed_possibleConstructorReturn(e,t){return!t||"object"!==MarkAsViewed_typeof(t)&&"function"!=typeof t?function MarkAsViewed_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MarkAsViewed_getPrototypeOf(e){return(MarkAsViewed_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kt=function(e){!function MarkAsViewed_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MarkAsViewed_setPrototypeOf(e,t)}(MarkAsViewed,e);var t=MarkAsViewed_createSuper(MarkAsViewed);function MarkAsViewed(){return MarkAsViewed_classCallCheck(this,MarkAsViewed),t.apply(this,arguments)}return function MarkAsViewed_createClass(e,t,r){return t&&MarkAsViewed_defineProperties(e.prototype,t),r&&MarkAsViewed_defineProperties(e,r),e}(MarkAsViewed,[{key:"componentDidMount",value:function componentDidMount(){var e=this.props.document;this.viewTimeout=setTimeout(MarkAsViewed_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var t;return regeneratorRuntime.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.view();case 2:(t=r.sent)&&e.updateLastViewed(t);case 4:case"end":return r.stop()}}),_callee)}))),3e3)}},{key:"componentWillUnmount",value:function componentWillUnmount(){clearTimeout(this.viewTimeout)}},{key:"render",value:function render(){return this.props.children||null}}]),MarkAsViewed}(o.Component),Wt=r("w/EL");r("TWNs"),r("JfAA"),r("GKVU");function ReferenceListItem_extends(){return(ReferenceListItem_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ReferenceListItem_objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=function ReferenceListItem_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var Vt=Object(P.default)(je.a).withConfig({displayName:"ReferenceListItem__DocumentLink",componentId:"sc-21q72c-0"})(["display:block;margin:2px -8px;padding:6px 8px;border-radius:8px;max-height:50vh;min-width:100%;overflow:hidden;position:relative;&:hover,&:active,&:focus{background:",";}"],(function(e){return e.theme.listItemHoverBackground})),Ut=P.default.h3.withConfig({displayName:"ReferenceListItem__Title",componentId:"sc-21q72c-1"})(["display:flex;align-items:center;overflow:hidden;text-overflow:ellipsis;font-size:14px;margin-top:0;margin-bottom:0.25em;white-space:nowrap;color:",';font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;'],(function(e){return e.theme.text})),Ft=Object(P.default)(w.DocumentIcon).withConfig({displayName:"ReferenceListItem__StyledDocumentIcon",componentId:"sc-21q72c-2"})(["margin-left:-4px;color:",";"],(function(e){return e.theme.textSecondary})),Gt=P.default.span.withConfig({displayName:"ReferenceListItem__Emoji",componentId:"sc-21q72c-3"})(["display:inline-flex;align-items:center;justify-content:center;margin-left:-4px;font-size:16px;width:24px;height:24px;"]);var qt=Object(n.d)((function ReferenceListItem(e){var t=e.document,r=e.showCollection,n=e.anchor,i=e.shareId,a=ReferenceListItem_objectWithoutProperties(e,["document","showCollection","anchor","shareId"]);return o.createElement(Vt,ReferenceListItem_extends({to:{pathname:i?"/share/".concat(i).concat(t.url):t.url,hash:n?"d-".concat(n):void 0,state:{title:t.title}}},a),o.createElement(Ut,{dir:"auto"},t.emoji?o.createElement(Gt,null,t.emoji):o.createElement(Ft,{color:"currentColor"})," ",t.emoji?t.title.replace(new RegExp("^".concat(t.emoji)),""):t.title),t.updatedBy&&o.createElement(se.a,{document:t,showCollection:r}))}));var $t,Jt=Object(n.d)((function PublicReferences(e){var t=Object(y.a)().t,r=e.shareId,n=e.documentId,i=e.sharedTree,a=o.useMemo((function(){var e;return function findChildren(t){if(t)return t.id===n?e=t.children:t.children.forEach((function(t){e||findChildren(t)})),e}(i)||[]}),[n,i]);return a.length?o.createElement(o.Fragment,null,o.createElement(Wt.a,null,t("Nested documents")),a.map((function(e){return o.createElement(qt,{key:e.id,document:e,shareId:r})}))):null})),Zt=(r("yR8a"),r("Obxi")),Xt=r("ZbbK"),Yt=r("bx9X");function References_typeof(e){return(References_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function References_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function References_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function References_setPrototypeOf(e,t){return(References_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function References_createSuper(e){var t=function References_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=References_getPrototypeOf(e);if(t){var o=References_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return References_possibleConstructorReturn(this,r)}}function References_possibleConstructorReturn(e,t){return!t||"object"!==References_typeof(t)&&"function"!=typeof t?function References_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function References_getPrototypeOf(e){return(References_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qt,er,tr,rr,nr,or,ir,ar,cr,ur,lr,sr,pr,fr,dr,mr,yr=Object(n.d)($t=function(e){!function References_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&References_setPrototypeOf(e,t)}(References,e);var t=References_createSuper(References);function References(){return References_classCallCheck(this,References),t.apply(this,arguments)}return function References_createClass(e,t,r){return t&&References_defineProperties(e.prototype,t),r&&References_defineProperties(e,r),e}(References,[{key:"componentDidMount",value:function componentDidMount(){this.props.documents.fetchBacklinks(this.props.document.id)}},{key:"render",value:function render(){var e=this.props,t=e.documents,r=e.collections,n=e.document,i=t.getBacklinedDocuments(n.id),a=r.get(n.collectionId),c=a?a.getDocumentChildren(n.id):[],u=!!i.length,l=!!c.length,s="#backlinks"===this.props.location.hash||!l;return(u||l)&&o.createElement(Zt.a,null,o.createElement(Yt.a,null,l&&o.createElement(Xt.a,{to:"#children",isActive:function isActive(){return!s}},"Nested documents"),u&&o.createElement(Xt.a,{to:"#backlinks",isActive:function isActive(){return s}},"Referenced by")),s?i.map((function(e){return o.createElement(qt,{anchor:n.urlId,key:e.id,document:e,showCollection:e.collectionId!==n.collectionId})})):c.map((function(e){var r=t.get(e.id);return o.createElement(qt,{key:e.id,document:r||e,showCollection:!1})})))}}]),References}(o.Component))||$t,br=Object(d.l)(Object(n.c)("documents","collections")(yr)),hr=r("PgNS");function Document_typeof(e){return(Document_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Document_templateObject2(){var e=Document_taggedTemplateLiteral(["\n    max-width: calc(48px + 52em);\n  "]);return Document_templateObject2=function _templateObject2(){return e},e}function Document_templateObject(){var e=Document_taggedTemplateLiteral(["\t\n    padding: 0 24px;\n    margin: 4px auto 12px;\n    max-width: calc(48px + ",");\n  "]);return Document_templateObject=function _templateObject(){return e},e}function Document_taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Document_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Document_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Document_ownKeys(Object(r),!0).forEach((function(t){Document_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Document_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Document_defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Document_asyncGeneratorStep(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function Document_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function _next(e){Document_asyncGeneratorStep(i,n,o,_next,_throw,"next",e)}function _throw(e){Document_asyncGeneratorStep(i,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function Document_initializerDefineProperty(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function Document_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Document_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Document_setPrototypeOf(e,t){return(Document_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function Document_createSuper(e){var t=function Document_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=Document_getPrototypeOf(e);if(t){var o=Document_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Document_possibleConstructorReturn(this,r)}}function Document_possibleConstructorReturn(e,t){return!t||"object"!==Document_typeof(t)&&"function"!=typeof t?Document_assertThisInitialized(e):t}function Document_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Document_getPrototypeOf(e){return(Document_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Document_applyDecoratedDescriptor(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var vr=(Qt=Object(j.a)("m"),er=Object(j.a)("e"),tr=Object(j.a)("esc"),rr=Object(j.a)("h"),nr=Object(j.a)("".concat(Ke.b,"+shift+p")),or=Object(j.a)("ctrl+alt+h"),Object(n.d)((ar=function(e){!function Document_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Document_setPrototypeOf(e,t)}(DocumentScene,e);var t=Document_createSuper(DocumentScene);function DocumentScene(){var e,r;Document_classCallCheck(this,DocumentScene);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Document_possibleConstructorReturn(r,(e=r=t.call.apply(t,[this].concat(o)),Document_initializerDefineProperty(r,"editor",cr,Document_assertThisInitialized(r)),Document_initializerDefineProperty(r,"isUploading",ur,Document_assertThisInitialized(r)),Document_initializerDefineProperty(r,"isSaving",lr,Document_assertThisInitialized(r)),Document_initializerDefineProperty(r,"isPublishing",sr,Document_assertThisInitialized(r)),Document_initializerDefineProperty(r,"isDirty",pr,Document_assertThisInitialized(r)),Document_initializerDefineProperty(r,"isEmpty",fr,Document_assertThisInitialized(r)),Document_initializerDefineProperty(r,"lastRevision",dr,Document_assertThisInitialized(r)),Document_initializerDefineProperty(r,"title",mr,Document_assertThisInitialized(r)),r.getEditorText=function(){return r.props.document.text},r.onSave=Document_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var e,t,n,o,i,a,c=arguments;return regeneratorRuntime.wrap((function _callee$(u){for(;;)switch(u.prev=u.next){case 0:if(e=c.length>0&&void 0!==c[0]?c[0]:{},!(t=r.props.document).isSaving){u.next=4;break}return u.abrupt("return");case 4:if(n=r.getEditorText?r.getEditorText():t.text,o=r.title,""!==n.trim()||""!==o.trim){u.next=8;break}return u.abrupt("return");case 8:if(!e.autosave||t.text.trim()!==n.trim()||t.title.trim()!==o.trim()){u.next=10;break}return u.abrupt("return");case 10:return t.title=o,t.text=n,i=!t.id,r.isSaving=!0,r.isPublishing=!!e.publish,t.tasks=getTasks(t.text),u.prev=16,u.next=19,t.save(Document_objectSpread(Document_objectSpread({},e),{},{lastRevision:r.lastRevision}));case 19:a=u.sent,r.isDirty=!1,r.lastRevision=a.revision,e.done?(r.props.history.push(a.url),r.props.ui.setActiveDocument(a)):i&&(r.props.history.push(Object(We.e)(a)),r.props.ui.setActiveDocument(a)),u.next=28;break;case 25:u.prev=25,u.t0=u.catch(16),r.props.toasts.showToast(u.t0.message,{type:"error"});case 28:return u.prev=28,r.isSaving=!1,r.isPublishing=!1,u.finish(28);case 32:case"end":return u.stop()}}),_callee,null,[[16,25,28,32]])}))),r.autosave=O()((function(){r.onSave({done:!1,autosave:!0})}),3e3),r.updateIsDirty=function(){var e=r.props.document,t=r.getEditorText().trim(),n=r.title!==e.title,o=t!==e.text.trim();r.isEmpty=!(t&&"#"!==t||r.title),r.isDirty=o||n},r.updateIsDirtyDebounced=O()(r.updateIsDirty,500),r.onImageUploadStart=function(){r.isUploading=!0},r.onImageUploadStop=function(){r.isUploading=!1},r.onChange=function(e){r.getEditorText=e,r.props.readOnly?(r.updateIsDirty(),r.onSave({done:!1,autosave:!0})):(r.updateIsDirtyDebounced(),r.autosave())},r.onChangeTitle=function(e){r.title=e.target.value,r.updateIsDirtyDebounced(),r.autosave()},r.goBack=function(){r.props.history.push(r.props.document.url)},e))}return function Document_createClass(e,t,r){return t&&Document_defineProperties(e.prototype,t),r&&Document_defineProperties(e,r),e}(DocumentScene,[{key:"componentDidMount",value:function componentDidMount(){this.updateIsDirty()}},{key:"componentDidUpdate",value:function componentDidUpdate(e){var t=this.props,r=t.auth,n=t.document,o=t.t;e.readOnly&&!this.props.readOnly&&this.updateIsDirty(),this.props.readOnly?(this.lastRevision=n.revision,n.title!==this.title&&(this.title=n.title)):e.document.revision!==this.lastRevision&&r.user&&n.updatedBy.id!==r.user.id&&this.props.toasts.showToast(o("Document updated by {{userName}}",{userName:n.updatedBy.name}),{timeout:3e4,type:"warning",action:{text:"Reload",onClick:function onClick(){window.location.href=Object(We.d)(n)}}}),n.injectTemplate&&(n.injectTemplate=!1,this.title=n.title,this.isDirty=!0,this.updateIsDirty())}},{key:"goToMove",value:function goToMove(e){if(this.props.readOnly){e.preventDefault();var t=this.props,r=t.document;t.abilities.move&&this.props.history.push(Object(We.c)(r))}}},{key:"goToEdit",value:function goToEdit(e){if(this.props.readOnly){e.preventDefault();var t=this.props,r=t.document;t.abilities.update&&this.props.history.push(Object(We.e)(r))}}},{key:"goBack",value:function goBack(e){this.props.readOnly||(e.preventDefault(),this.props.history.goBack())}},{key:"goToHistory",value:function goToHistory(e){if(this.props.readOnly){e.preventDefault();var t=this.props,r=t.document;t.revision?this.props.history.push(r.url):this.props.history.push(Object(We.b)(r))}}},{key:"onPublish",value:function onPublish(e){e.preventDefault(),this.props.document.publishedAt||this.onSave({publish:!0,done:!0})}},{key:"onToggleTableOfContents",value:function onToggleTableOfContents(e){if(this.props.readOnly){e.preventDefault();var t=this.props.ui;t.tocVisible?t.hideTableOfContents():t.showTableOfContents()}}},{key:"render",value:function render(){var e,t=this,r=this.props,n=r.document,i=r.revision,a=r.readOnly,c=r.abilities,u=r.auth,l=r.ui,s=r.match,p=r.t,f=u.team,m=s.params.shareId,y=!!m,b=i?i.text:n.text,h=n.injectTemplate,g=f&&!1===f.documentEmbeds||n.embedsDisabled,_=this.editor.current?this.editor.current.getHeadings():[],O=l.tocVisible&&a;return o.createElement(L.a,null,o.createElement(_r,{key:i?i.id:n.id,isShare:y,column:!0,auto:!0},o.createElement(d.c,{path:"".concat(s.url,"/move"),component:function component(){return o.createElement(M.a,{title:"Move ".concat(n.noun),onRequestClose:t.goBack,isOpen:!0},o.createElement(k.a,{document:n,onRequestClose:t.goBack}))}}),o.createElement(v.a,{title:n.titleWithDefault.replace(n.emoji,""),favicon:n.emoji?(e=n.emoji,"data:image/svg+xml;data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>".concat(e,"</text></svg>")):void 0}),(this.isUploading||this.isSaving)&&o.createElement(z.b,null),o.createElement(K,{justify:"center",column:!0,auto:!0},!a&&o.createElement(o.Fragment,null,o.createElement(d.a,{when:this.isDirty&&!this.isUploading,message:p("You have unsaved changes.\nAre you sure you want to discard them?")}),o.createElement(d.a,{when:this.isUploading&&!this.isDirty,message:p("Images are still uploading.\nAre you sure you want to discard them?")})),o.createElement(Rt,{document:n,shareId:m,isRevision:!!i,isDraft:n.isDraft,isEditing:!a,isSaving:this.isSaving,isPublishing:this.isPublishing,publishingIsDisabled:n.isSaving||this.isPublishing||this.isEmpty,savingIsDisabled:n.isSaving||this.isEmpty,sharedTree:this.props.sharedTree,goBack:this.goBack,onSave:this.onSave,headings:_}),o.createElement(wr,{archived:n.isArchived,showContents:O,column:!0,auto:!0},n.isTemplate&&!a&&o.createElement(H.a,{muted:!0},o.createElement(D.a,null,"You’re editing a template. Highlight some text and use the"," ",o.createElement(gr,{color:"currentColor"})," control to add placeholders that can be filled out when creating new documents from this template.")),n.archivedAt&&!n.deletedAt&&o.createElement(H.a,{muted:!0},p("Archived by {{userName}}",{userName:n.updatedBy.name})," ",o.createElement(N.a,{dateTime:n.updatedAt,addSuffix:!0})),n.deletedAt&&o.createElement(H.a,{muted:!0},o.createElement("strong",null,p("Deleted by {{userName}}",{userName:n.updatedBy.name})," ",o.createElement(N.a,{dateTime:n.deletedAt||"",addSuffix:!0})),n.permanentlyDeletedAt&&o.createElement(o.Fragment,null,o.createElement("br",null),n.template?o.createElement(D.a,null,"This template will be permanently deleted in"," ",o.createElement(N.a,{dateTime:n.permanentlyDeletedAt})," ","unless restored."):o.createElement(D.a,null,"This document will be permanently deleted in"," ",o.createElement(N.a,{dateTime:n.permanentlyDeletedAt})," ","unless restored."))),o.createElement(o.Suspense,{fallback:o.createElement(B.a,null)},o.createElement(R.a,{auto:!a},O&&o.createElement(Contents,{headings:_}),o.createElement(Ge,{id:n.id,innerRef:this.editor,shareId:m,isDraft:n.isDraft,template:n.isTemplate,key:[h,g].join("-"),title:i?i.title:this.title,document:n,value:a?b:void 0,defaultValue:b,disableEmbeds:g,onImageUploadStart:this.onImageUploadStart,onImageUploadStop:this.onImageUploadStop,onSearchLink:this.props.onSearchLink,onCreateLink:this.props.onCreateLink,onChangeTitle:this.onChangeTitle,onChange:this.onChange,onSave:this.onSave,onPublish:this.onPublish,onCancel:this.goBack,readOnly:a,readOnlyWriteCheckboxes:a&&c.update,ui:this.props.ui},m&&o.createElement(Or,{isOnlyTitle:n.isOnlyTitle},o.createElement(Jt,{shareId:m,documentId:n.id,sharedTree:this.props.sharedTree})),!y&&!i&&o.createElement(o.Fragment,null,o.createElement(Kt,{document:n}),o.createElement(Or,{isOnlyTitle:n.isOnlyTitle},o.createElement(br,{document:n}))))))))),y&&!Object(hr.b)()&&o.createElement(A,{href:"//www.getoutline.com?ref=sharelink"}),!y&&o.createElement(Nt,null))}}]),DocumentScene}(o.Component),cr=Document_applyDecoratedDescriptor(ar.prototype,"editor",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return o.createRef()}}),ur=Document_applyDecoratedDescriptor(ar.prototype,"isUploading",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return!1}}),lr=Document_applyDecoratedDescriptor(ar.prototype,"isSaving",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return!1}}),sr=Document_applyDecoratedDescriptor(ar.prototype,"isPublishing",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return!1}}),pr=Document_applyDecoratedDescriptor(ar.prototype,"isDirty",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return!1}}),fr=Document_applyDecoratedDescriptor(ar.prototype,"isEmpty",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return!0}}),dr=Document_applyDecoratedDescriptor(ar.prototype,"lastRevision",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return this.props.document.revision}}),mr=Document_applyDecoratedDescriptor(ar.prototype,"title",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function initializer(){return this.props.document.title}}),Document_applyDecoratedDescriptor(ar.prototype,"goToMove",[Qt],Object.getOwnPropertyDescriptor(ar.prototype,"goToMove"),ar.prototype),Document_applyDecoratedDescriptor(ar.prototype,"goToEdit",[er],Object.getOwnPropertyDescriptor(ar.prototype,"goToEdit"),ar.prototype),Document_applyDecoratedDescriptor(ar.prototype,"goBack",[tr],Object.getOwnPropertyDescriptor(ar.prototype,"goBack"),ar.prototype),Document_applyDecoratedDescriptor(ar.prototype,"goToHistory",[rr],Object.getOwnPropertyDescriptor(ar.prototype,"goToHistory"),ar.prototype),Document_applyDecoratedDescriptor(ar.prototype,"onPublish",[nr],Object.getOwnPropertyDescriptor(ar.prototype,"onPublish"),ar.prototype),Document_applyDecoratedDescriptor(ar.prototype,"onToggleTableOfContents",[or],Object.getOwnPropertyDescriptor(ar.prototype,"onToggleTableOfContents"),ar.prototype),ir=ar))||ir),gr=Object(P.default)(w.InputIcon).withConfig({displayName:"Document__PlaceholderIcon",componentId:"e560ta-0"})(["position:relative;top:6px;"]),_r=Object(P.default)(K).withConfig({displayName:"Document__Background",componentId:"e560ta-1"})(["background:",";transition:",";"],(function(e){return e.theme.background}),(function(e){return e.theme.backgroundTransition})),Or=Object(P.default)("div").withConfig({displayName:"Document__ReferencesWrapper",componentId:"e560ta-2"})(["margin-top:","px;@media print{display:none;}"],(function(e){return e.isOnlyTitle?-45:16})),wr=Object(P.default)(R.a).withConfig({displayName:"Document__MaxWidth",componentId:"e560ta-3"})(["",";padding:0 12px;max-width:100vw;width:100%;",";",";"],(function(e){return e.archived&&"* { color: ".concat(e.theme.textSecondary," !important; } ")}),Object(S.a)("tablet")(Document_templateObject(),(function(e){return e.showContents?"64em":"46em"})),Object(S.a)("desktopLarge")(Document_templateObject2())),Dr=Object(d.l)(Object(E.a)()(Object(n.c)("ui","auth","toasts")(vr)));function HideSidebar_typeof(e){return(HideSidebar_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HideSidebar_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HideSidebar_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function HideSidebar_setPrototypeOf(e,t){return(HideSidebar_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function HideSidebar_createSuper(e){var t=function HideSidebar_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=HideSidebar_getPrototypeOf(e);if(t){var o=HideSidebar_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return HideSidebar_possibleConstructorReturn(this,r)}}function HideSidebar_possibleConstructorReturn(e,t){return!t||"object"!==HideSidebar_typeof(t)&&"function"!=typeof t?function HideSidebar_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HideSidebar_getPrototypeOf(e){return(HideSidebar_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Er=function(e){!function HideSidebar_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HideSidebar_setPrototypeOf(e,t)}(HideSidebar,e);var t=HideSidebar_createSuper(HideSidebar);function HideSidebar(){return HideSidebar_classCallCheck(this,HideSidebar),t.apply(this,arguments)}return function HideSidebar_createClass(e,t,r){return t&&HideSidebar_defineProperties(e.prototype,t),r&&HideSidebar_defineProperties(e,r),e}(HideSidebar,[{key:"componentDidMount",value:function componentDidMount(){this.props.ui.enableEditMode()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.ui.disableEditMode()}},{key:"render",value:function render(){return this.props.children||null}}]),HideSidebar}(o.Component);function Loading(e){var t=e.location,r=Object(y.a)().t;return o.createElement(K,{column:!0,auto:!0},o.createElement(v.a,{title:t.state?t.state.title:r("Untitled")}),o.createElement(b.a,null,o.createElement(B.a,null)))}var jr=r("E25U");function SocketPresence_typeof(e){return(SocketPresence_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SocketPresence_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SocketPresence_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function SocketPresence_setPrototypeOf(e,t){return(SocketPresence_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function SocketPresence_createSuper(e){var t=function SocketPresence_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=SocketPresence_getPrototypeOf(e);if(t){var o=SocketPresence_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return SocketPresence_possibleConstructorReturn(this,r)}}function SocketPresence_possibleConstructorReturn(e,t){return!t||"object"!==SocketPresence_typeof(t)&&"function"!=typeof t?function SocketPresence_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SocketPresence_getPrototypeOf(e){return(SocketPresence_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pr=function(e){!function SocketPresence_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SocketPresence_setPrototypeOf(e,t)}(SocketPresence,e);var t=SocketPresence_createSuper(SocketPresence);function SocketPresence(){var e,r;SocketPresence_classCallCheck(this,SocketPresence);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return SocketPresence_possibleConstructorReturn(r,(e=r=t.call.apply(t,[this].concat(o)),r.setupOnce=function(){r.context&&r.context!==r.previousContext&&(r.previousContext=r.context,r.context.authenticated&&r.emitJoin(),r.context.on("authenticated",(function(){r.emitJoin()})))},r.emitJoin=function(){r.context&&r.context.emit("join",{documentId:r.props.documentId,isEditing:r.props.isEditing})},r.emitPresence=function(){r.context&&r.context.emit("presence",{documentId:r.props.documentId,isEditing:r.props.isEditing})},e))}return function SocketPresence_createClass(e,t,r){return t&&SocketPresence_defineProperties(e.prototype,t),r&&SocketPresence_defineProperties(e,r),e}(SocketPresence,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.editingInterval=setInterval((function(){e.props.isEditing&&e.emitPresence()}),ne.c),this.setupOnce()}},{key:"componentDidUpdate",value:function componentDidUpdate(e){this.setupOnce(),e.isEditing!==this.props.isEditing&&this.emitPresence()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.context&&(this.context.emit("leave",{documentId:this.props.documentId}),this.context.off("authenticated",this.emitJoin)),clearInterval(this.editingInterval)}},{key:"render",value:function render(){return this.props.children||null}}]),SocketPresence}(o.Component);Pr.contextType=jr.a;var Sr,xr,kr,Cr,Tr,Ir=r("WHvW");function DataLoader_typeof(e){return(DataLoader_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DataLoader_asyncGeneratorStep(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function DataLoader_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function _next(e){DataLoader_asyncGeneratorStep(i,n,o,_next,_throw,"next",e)}function _throw(e){DataLoader_asyncGeneratorStep(i,n,o,_next,_throw,"throw",e)}_next(void 0)}))}}function DataLoader_initializerDefineProperty(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function DataLoader_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DataLoader_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function DataLoader_setPrototypeOf(e,t){return(DataLoader_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function DataLoader_createSuper(e){var t=function DataLoader_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=DataLoader_getPrototypeOf(e);if(t){var o=DataLoader_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return DataLoader_possibleConstructorReturn(this,r)}}function DataLoader_possibleConstructorReturn(e,t){return!t||"object"!==DataLoader_typeof(t)&&"function"!=typeof t?DataLoader_assertThisInitialized(e):t}function DataLoader_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DataLoader_getPrototypeOf(e){return(DataLoader_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DataLoader_applyDecoratedDescriptor(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Ar={},Lr=Object(n.d)((xr=function(e){!function DataLoader_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DataLoader_setPrototypeOf(e,t)}(DataLoader,e);var t=DataLoader_createSuper(DataLoader);function DataLoader(){var e,r;DataLoader_classCallCheck(this,DataLoader);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return DataLoader_possibleConstructorReturn(r,(e=r=t.call.apply(t,[this].concat(o)),DataLoader_initializerDefineProperty(r,"document",kr,DataLoader_assertThisInitialized(r)),DataLoader_initializerDefineProperty(r,"revision",Cr,DataLoader_assertThisInitialized(r)),DataLoader_initializerDefineProperty(r,"error",Tr,DataLoader_assertThisInitialized(r)),r.onSearchLink=function(){var e=DataLoader_asyncToGenerator(regeneratorRuntime.mark((function _callee(e){var t,n,o,i,c;return regeneratorRuntime.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(!Object(ke.c)(e)){s.next=15;break}return t=parseDocumentSlug(e),s.prev=2,s.next=5,r.props.documents.fetch(t);case 5:return n=s.sent,o=n.document,i=Object(l.a)(Date.parse(o.updatedAt),{addSuffix:!0}),s.abrupt("return",[{title:o.title,subtitle:"Updated ".concat(i),url:o.url}]);case 11:if(s.prev=11,s.t0=s.catch(2),s.t0 instanceof Ir.d){s.next=15;break}throw s.t0;case 15:return s.next=17,r.props.documents.searchTitles(e);case 17:return c=s.sent,s.abrupt("return",a()(c.map((function(e){var t=Object(l.a)(Date.parse(e.updatedAt),{addSuffix:!0});return{title:e.title,subtitle:"Updated ".concat(t),url:e.url}})),(function(t){return u()(t.title).toLowerCase().startsWith(u()(e).toLowerCase())?-1:1})));case 19:case"end":return s.stop()}}),_callee,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),r.onCreateLink=function(){var e=DataLoader_asyncToGenerator(regeneratorRuntime.mark((function _callee2(e){var t,n;return regeneratorRuntime.wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return t=r.document,p()(t,"document must be loaded to create link"),o.next=4,r.props.documents.create({collectionId:t.collectionId,parentDocumentId:t.parentDocumentId,title:e,text:""});case 4:return n=o.sent,o.abrupt("return",n.url);case 6:case"end":return o.stop()}}),_callee2)})));return function(t){return e.apply(this,arguments)}}(),r.loadRevision=DataLoader_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var e;return regeneratorRuntime.wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:return e=r.props.match.params.revisionId,t.next=3,r.props.revisions.fetch(e);case 3:r.revision=t.sent;case 4:case"end":return t.stop()}}),_callee3)}))),r.loadDocument=DataLoader_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var e,t,n,o,i,a,c,u,l;return regeneratorRuntime.wrap((function _callee4$(s){for(;;)switch(s.prev=s.next){case 0:return e=r.props.match.params,t=e.shareId,n=e.documentSlug,o=e.revisionId,r.document&&r.props.ui.setActiveDocument(r.document),s.prev=2,s.next=5,r.props.documents.fetch(n,{shareId:t});case 5:if(i=s.sent,r.sharedTree=i.sharedTree,r.document=i.document,Ar[r.document.id]=i.sharedTree,!o||"latest"===o){s.next=14;break}return s.next=12,r.loadRevision();case 12:s.next=15;break;case 14:r.revision=void 0;case 15:s.next=21;break;case 17:return s.prev=17,s.t0=s.catch(2),r.error=s.t0,s.abrupt("return");case 21:if(!(a=r.document)){s.next=32;break}if(c=r.props.policies.abilities(a.id),r.props.ui.setActiveDocument(a),c.update||!r.isEditing){s.next=28;break}return r.props.history.push(a.url),s.abrupt("return");case 28:c.read&&r.props.shares.fetch(a.id).catch((function(e){if(!(e instanceof Ir.d))throw e})),u=r.props.location.pathname.match(/move$/),!o&&!u&&!t&&(l=Object(We.l)(r.props.match.url,a),r.props.location.pathname!==l&&r.props.history.replace(l));case 32:case"end":return s.stop()}}),_callee4,null,[[2,17]])}))),e))}return function DataLoader_createClass(e,t,r){return t&&DataLoader_defineProperties(e.prototype,t),r&&DataLoader_defineProperties(e,r),e}(DataLoader,[{key:"componentDidMount",value:function componentDidMount(){var e=this.props,t=e.documents,r=e.match;this.document=t.getByUrl(r.params.documentSlug),this.sharedTree=this.document?Ar[this.document.id]:void 0,this.loadDocument()}},{key:"componentDidUpdate",value:function componentDidUpdate(e){if(this.document){var t=this.document;!this.props.policies.get(t.id)&&!this.error&&this.props.auth.user&&this.props.auth.user.id&&this.loadDocument()}var r=this.props.match.params.revisionId;e.match.params.revisionId!==r&&r&&"latest"!==r&&this.loadRevision()}},{key:"render",value:function render(){var e=this.props,t=e.location,r=e.policies,n=e.ui;if(this.error)return this.error instanceof Ir.e?o.createElement(g,null):o.createElement(m.a,null);var i=this.document,a=this.revision;if(!i)return o.createElement(o.Fragment,null,o.createElement(Loading,{location:t}),this.isEditing&&o.createElement(Er,{ui:n}));var c=r.abilities(i.id);return o.createElement(Pr,{documentId:i.id,isEditing:this.isEditing},this.isEditing&&o.createElement(Er,{ui:n}),o.createElement(Dr,{document:i,revision:a,abilities:c,location:t,readOnly:!this.isEditing||!c.update||i.isArchived,onSearchLink:this.onSearchLink,onCreateLink:this.onCreateLink,sharedTree:this.sharedTree}))}},{key:"isEditing",get:function get(){return this.props.match.path===We.g}}]),DataLoader}(o.Component),kr=DataLoader_applyDecoratedDescriptor(xr.prototype,"document",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cr=DataLoader_applyDecoratedDescriptor(xr.prototype,"revision",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tr=DataLoader_applyDecoratedDescriptor(xr.prototype,"error",[f.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sr=xr))||Sr,Rr=Object(d.l)(Object(n.c)("ui","auth","documents","revisions","policies","shares")(Lr));function KeyedDocument_typeof(e){return(KeyedDocument_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KeyedDocument_extends(){return(KeyedDocument_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function KeyedDocument_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KeyedDocument_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function KeyedDocument_setPrototypeOf(e,t){return(KeyedDocument_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function KeyedDocument_createSuper(e){var t=function KeyedDocument_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=KeyedDocument_getPrototypeOf(e);if(t){var o=KeyedDocument_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return KeyedDocument_possibleConstructorReturn(this,r)}}function KeyedDocument_possibleConstructorReturn(e,t){return!t||"object"!==KeyedDocument_typeof(t)&&"function"!=typeof t?function KeyedDocument_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KeyedDocument_getPrototypeOf(e){return(KeyedDocument_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zr=function(e){!function KeyedDocument_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KeyedDocument_setPrototypeOf(e,t)}(KeyedDocument,e);var t=KeyedDocument_createSuper(KeyedDocument);function KeyedDocument(){return KeyedDocument_classCallCheck(this,KeyedDocument),t.apply(this,arguments)}return function KeyedDocument_createClass(e,t,r){return t&&KeyedDocument_defineProperties(e.prototype,t),r&&KeyedDocument_defineProperties(e,r),e}(KeyedDocument,[{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.ui.clearActiveDocument()}},{key:"render",value:function render(){var e=this.props.match.params,t=e.documentSlug,r=e.revisionId,n=t?t.split("-"):[],i=n.length?n[n.length-1]:void 0;return o.createElement(Rr,KeyedDocument_extends({key:[i,r].join("/")},this.props))}}]),KeyedDocument}(o.Component);t.default=Object(n.c)("ui")(zr)}}]);
//# sourceMappingURL=keyed-document.dfbbb01819649fd37542.js.map