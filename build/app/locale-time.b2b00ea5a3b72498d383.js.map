{"version":3,"sources":["webpack:///./app/components/LocaleTime.js","webpack:///./app/hooks/useUserLocale.js"],"names":["locales","en_US","enUS","de_DE","de","es_ES","es","fa_IR","faIR","fr_FR","fr","it_IT","it","ja_JP","ja","ko_KR","ko","pt_BR","ptBR","pt_PT","pt","zh_CN","zhCN","zh_TW","zhTW","ru_RU","ru","callbacks","setInterval","forEach","cb","LocaleTime","addSuffix","children","dateTime","shorten","tooltipDelay","userLocale","useUserLocale","auth","useStores","user","language","React","setMinutesMounted","callback","current","eachMinute","fn","push","filter","state","content","formatDistanceToNow","Date","parse","locale","undefined","replace","Tooltip","tooltip","format","delay","placement"],"mappings":"y8CAqBA,IAAMA,EAAU,CACdC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,IACPC,MAAOC,KAGLC,EAAY,GAIhBC,aAAY,WACVD,EAAUE,SAAQ,SAACC,GAAD,OAAQA,SACzB,KAgEYC,UA9Cf,SAASA,WAAT,GAMU,IALRC,EAKQ,EALRA,UACAC,EAIQ,EAJRA,SACAC,EAGQ,EAHRA,SACAC,EAEQ,EAFRA,QACAC,EACQ,EADRA,aAEMC,ECjEO,SAASC,gBAAgB,IAC9BC,EAASC,cAATD,KAER,GAAKA,EAAKE,MAASF,EAAKE,KAAKC,SAI7B,OAAOH,EAAKE,KAAKC,SD0DEJ,GADX,iBAEuBK,WAAe,GAFtC,GAEEC,GAFF,WAGFC,EAAWF,WAEjBA,aAAgB,WAKd,OAJAE,EAASC,QA5Bb,SAASC,WAAWC,GAGlB,OAFArB,EAAUsB,KAAKD,GAER,WACLrB,EAAYA,EAAUuB,QAAO,SAACpB,GAAD,OAAQA,IAAOkB,MAwBzBD,EAAW,WAC5BH,GAAkB,SAACO,GAAD,QAAaA,QAG1B,WACDN,EAASC,SACXD,EAASC,aAGZ,IAEH,IAAIM,EAAUC,YAAoBC,KAAKC,MAAMrB,GAAW,CACtDF,YACAwB,OAAQnB,EAAarC,EAAQqC,QAAcoB,IAU7C,OAPItB,IACFiB,EAAUA,EACPM,QAAQ,QAAS,IACjBA,QAAQ,yBAA0B,YAClCA,QAAQ,SAAU,QAIrB,gBAACC,EAAA,EAAD,CACEC,QAASC,YAAOP,KAAKC,MAAMrB,GAAW,wBACtC4B,MAAO1B,EACP2B,UAAU,UAEV,wBAAM7B,SAAUA,GAAWD,GAAYmB","file":"locale-time.b2b00ea5a3b72498d383.js","sourcesContent":["// @flow\nimport { format, formatDistanceToNow } from \"date-fns\";\nimport {\n  enUS,\n  de,\n  faIR,\n  fr,\n  es,\n  it,\n  ja,\n  ko,\n  ptBR,\n  pt,\n  zhCN,\n  zhTW,\n  ru,\n} from \"date-fns/locale\";\nimport * as React from \"react\";\nimport Tooltip from \"components/Tooltip\";\nimport useUserLocale from \"hooks/useUserLocale\";\n\nconst locales = {\n  en_US: enUS,\n  de_DE: de,\n  es_ES: es,\n  fa_IR: faIR,\n  fr_FR: fr,\n  it_IT: it,\n  ja_JP: ja,\n  ko_KR: ko,\n  pt_BR: ptBR,\n  pt_PT: pt,\n  zh_CN: zhCN,\n  zh_TW: zhTW,\n  ru_RU: ru,\n};\n\nlet callbacks = [];\n\n// This is a shared timer that fires every minute, used for\n// updating all Time components across the page all at once.\nsetInterval(() => {\n  callbacks.forEach((cb) => cb());\n}, 1000 * 60);\n\nfunction eachMinute(fn) {\n  callbacks.push(fn);\n\n  return () => {\n    callbacks = callbacks.filter((cb) => cb !== fn);\n  };\n}\n\ntype Props = {\n  dateTime: string,\n  children?: React.Node,\n  tooltipDelay?: number,\n  addSuffix?: boolean,\n  shorten?: boolean,\n};\n\nfunction LocaleTime({\n  addSuffix,\n  children,\n  dateTime,\n  shorten,\n  tooltipDelay,\n}: Props) {\n  const userLocale = useUserLocale();\n  const [_, setMinutesMounted] = React.useState(0); // eslint-disable-line no-unused-vars\n  const callback = React.useRef();\n\n  React.useEffect(() => {\n    callback.current = eachMinute(() => {\n      setMinutesMounted((state) => ++state);\n    });\n\n    return () => {\n      if (callback.current) {\n        callback.current();\n      }\n    };\n  }, []);\n\n  let content = formatDistanceToNow(Date.parse(dateTime), {\n    addSuffix,\n    locale: userLocale ? locales[userLocale] : undefined,\n  });\n\n  if (shorten) {\n    content = content\n      .replace(\"about\", \"\")\n      .replace(\"less than a minute ago\", \"just now\")\n      .replace(\"minute\", \"min\");\n  }\n\n  return (\n    <Tooltip\n      tooltip={format(Date.parse(dateTime), \"MMMM do, yyyy h:mm a\")}\n      delay={tooltipDelay}\n      placement=\"bottom\"\n    >\n      <time dateTime={dateTime}>{children || content}</time>\n    </Tooltip>\n  );\n}\n\nexport default LocaleTime;\n","// @flow\nimport useStores from \"./useStores\";\n\nexport default function useUserLocale() {\n  const { auth } = useStores();\n\n  if (!auth.user || !auth.user.language) {\n    return undefined;\n  }\n\n  return auth.user.language;\n}\n"],"sourceRoot":""}